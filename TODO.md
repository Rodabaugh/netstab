Improve error messages and add raise expections where reasonable